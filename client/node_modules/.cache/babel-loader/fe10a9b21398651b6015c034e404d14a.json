{"ast":null,"code":"import _regeneratorRuntime from \"/home/costantinos/Documenti/Dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/costantinos/Documenti/Dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/costantinos/Documenti/Dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/home/costantinos/Documenti/Dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/costantinos/Documenti/Dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _createClass from \"/home/costantinos/Documenti/Dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/costantinos/Documenti/Dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/costantinos/Documenti/Dapp/src/components/App.js\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport './App.css';\nimport ReactDOM from 'react-dom';\nimport Dapp from '../abis/Dapp.json';\nimport { OBJViewer, STLViewer } from 'react-stl-obj-viewer';\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\nimport designVoting from '../abis/designVoting.json';\nimport { ethers } from \"ethers\";\nimport bs58 from 'bs58';\nimport CurrencyInput from 'react-currency-input';\nimport { keccak256 } from 'js-sha3';\n\nvar NodeStl = require(\"node-stl\"); //connessione al nodo di infura per ipfs\n\n\nvar ipfsClient = require('ipfs-http-client');\n\nvar ipfs = ipfsClient({\n  host: 'ipfs.infura.io',\n  port: 5001,\n  protocol: 'https'\n});\nvar web3s = new Web3(new Web3.providers.WebsocketProvider('ws://localhost:7546')); //tipi di formato .stl (più comune) 3MF AMF e .obj(open source)\n// usa accept\n// url example:'https://ipfs.infura.io/ipfs/QmZsdEtccredWWGZzZvU5fStsC7aWADJch588qAarGTky9'\n//{`https://ipfs.infura.io/ipfs/${this.state.designHash}`}\n//const user = []\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    //operazioni quando il componente viene chiamato\n    value: function () {\n      var _componentWillMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.loadWeb3();\n\n              case 2:\n                if (!(this.state.ethBrowser == true)) {\n                  _context.next = 11;\n                  break;\n                }\n\n                _context.next = 5;\n                return this.loadBlockchainData();\n\n              case 5:\n                _context.next = 7;\n                return this.subscriptionEvents();\n\n              case 7:\n                _context.next = 9;\n                return this.cookiesLog();\n\n              case 9:\n                _context.next = 11;\n                return this.setState({\n                  loading: false\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: \"cookiesLog\",\n    value: function () {\n      var _cookiesLog = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var isLogged, inMain, inAnn, name, surname, email, designer, player, currentDesigns;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                isLogged = Cookies.get('log');\n                inMain = Cookies.get('main');\n                inAnn = Cookies.get('announce');\n                name = Cookies.get('name');\n                surname = Cookies.get('surname');\n                email = Cookies.get('email');\n                designer = Cookies.get('designer');\n                player = Cookies.get('player');\n                currentDesigns = Cookies.get('currentDesigns');\n\n                if (!isLogged) {\n                  _context2.next = 12;\n                  break;\n                }\n\n                _context2.next = 12;\n                return this.setState({\n                  isLogged: isLogged\n                });\n\n              case 12:\n                if (!inMain) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                _context2.next = 15;\n                return this.setState({\n                  main: inMain\n                });\n\n              case 15:\n                if (!inAnn) {\n                  _context2.next = 18;\n                  break;\n                }\n\n                _context2.next = 18;\n                return this.setState({\n                  announce: inAnn\n                });\n\n              case 18:\n                if (!name) {\n                  _context2.next = 21;\n                  break;\n                }\n\n                _context2.next = 21;\n                return this.setState({\n                  name: name\n                });\n\n              case 21:\n                if (!surname) {\n                  _context2.next = 24;\n                  break;\n                }\n\n                _context2.next = 24;\n                return this.setState({\n                  surname: surname\n                });\n\n              case 24:\n                if (!email) {\n                  _context2.next = 27;\n                  break;\n                }\n\n                _context2.next = 27;\n                return this.setState({\n                  email: email\n                });\n\n              case 27:\n                if (!designer) {\n                  _context2.next = 30;\n                  break;\n                }\n\n                _context2.next = 30;\n                return this.setState({\n                  designer: designer\n                });\n\n              case 30:\n                if (!player) {\n                  _context2.next = 33;\n                  break;\n                }\n\n                _context2.next = 33;\n                return this.setState({\n                  player: player\n                });\n\n              case 33:\n                if (!currentDesigns) {\n                  _context2.next = 36;\n                  break;\n                }\n\n                _context2.next = 36;\n                return this.setState({\n                  toCurrentDesigns: currentDesigns\n                });\n\n              case 36:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function cookiesLog() {\n        return _cookiesLog.apply(this, arguments);\n      }\n\n      return cookiesLog;\n    }()\n  }, {\n    key: \"subscriptionEvents\",\n    value: function subscriptionEvents() {\n      this.state.contract1.events.newDesignAvailable(function (error, event) {\n        console.log(event);\n      }).on('data', function (event) {\n        console.log(event); // same results as the optional callback above\n      }).on('changed', function (event) {// remove event from local database\n      }).on('error', console.error);\n      this.state.contract1.events.newPlayerAddition(function (error, event) {\n        console.log(event);\n      }).on('data', function (event) {\n        console.log(event); // same results as the optional callback above\n      }).on('changed', function (event) {// remove event from local database\n      }).on('error', console.error);\n    } //carico la finestra (metamask) web3 o la converto in web3\n\n  }, {\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!window.ethereum) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                window.web3 = new Web3(window.ethereum);\n                _context3.next = 4;\n                return window.ethereum.enable();\n\n              case 4:\n                _context3.next = 6;\n                return this.setState({\n                  ethBrowser: true\n                });\n\n              case 6:\n                _context3.next = 20;\n                break;\n\n              case 8:\n                if (!window.web3) {\n                  _context3.next = 14;\n                  break;\n                }\n\n                window.web3 = new Web3(window.web3.currentProvider);\n                _context3.next = 12;\n                return this.setState({\n                  ethBrowser: true\n                });\n\n              case 12:\n                _context3.next = 20;\n                break;\n\n              case 14:\n                console.log('Non-Ethereum browser detected. ');\n                _context3.next = 17;\n                return this.setState({\n                  ethBrowser: false\n                });\n\n              case 17:\n                _context3.next = 19;\n                return this.setState({\n                  loading: false\n                });\n\n              case 19:\n                return _context3.abrupt(\"return\");\n\n              case 20:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n\n      return loadWeb3;\n    }() // dati della blockchain:\n    //account è l'indirizzo di colui che firma la transazione\n    //networkid è l'id della connessione es:localhost:7545\n    //contract è la variabile del contratto\n    //designHash è l'hash del file salvato sull'ipfs\n\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var web3, accounts, networkId, networkData, contract, contract1;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                web3 = window.web3;\n                _context4.next = 3;\n                return web3.eth.getAccounts();\n\n              case 3:\n                accounts = _context4.sent;\n                this.setState({\n                  account: accounts[0]\n                });\n                console.log(accounts);\n                _context4.next = 8;\n                return web3.eth.net.getId();\n\n              case 8:\n                networkId = _context4.sent;\n                console.log(networkId);\n                networkData = designVoting.networks[networkId];\n                console.log(networkData);\n\n                if (networkData) {\n                  contract = web3.eth.Contract(designVoting.abi, networkData.address);\n                  contract1 = web3s.eth.Contract(designVoting.abi, networkData.address);\n                  this.setState({\n                    contract: contract,\n                    contract1: contract1\n                  });\n                } else {\n                  window.alert('Smart contract not deployed to detected network.');\n                }\n\n              case 13:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n\n      return loadBlockchainData;\n    }()\n  }, {\n    key: \"getBytes32FromIpfsHash\",\n    value: function getBytes32FromIpfsHash(_ipfsListing) {\n      return \"0x\" + bs58.decode(_ipfsListing).slice(2).toString('hex');\n    }\n  }, {\n    key: \"getIpfsHashFromBytes32\",\n    value: function getIpfsHashFromBytes32(bytes32Hex) {\n      var hashHex = \"1220\" + bytes32Hex.slice(2);\n      var hashBytes = Buffer.from(hashHex, 'hex');\n      var hashStr = bs58.encode(hashBytes);\n      return hashStr;\n    }\n  }]);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.testMeta = function (event) {\n      event.preventDefault();\n      var web3 = window.web3;\n      var try1 = web3.eth.accounts.create();\n      console.log(try1);\n    };\n\n    _this.startApi = function (event) {\n      event.preventDefault();\n      axios.get('http://127.0.0.1:5000/api/get1').then(function (response) {\n        console.log(response.data);\n      });\n    };\n\n    _this.startApi2 =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(event) {\n        var username, password, hpassword, wallet;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"sending data\");\n                username = _this.state.username;\n                password = _this.state.password;\n                hpassword = keccak256(password).toString('hex');\n                wallet = _this.state.account;\n                axios.post('http://127.0.0.1:5000/api/post1', {\n                  username: username,\n                  password: hpassword,\n                  wallet: wallet\n                }).then(function (response) {\n                  if (response.data.length == 1) {\n                    var name = response.data[0][3];\n                    var surname = response.data[0][4];\n                    var email = response.data[0][6];\n                    var registrationType = response.data[0][7];\n\n                    if (registrationType == \"designer\") {\n                      _this.setState({\n                        designer: true\n                      });\n\n                      console.log(\"logged as designer\");\n                    } else if (registrationType == \"player\") {\n                      _this.setState({\n                        player: true\n                      });\n\n                      console.log(\"logged as player\");\n                    } else if (registrationType == \"both\") {\n                      _this.setState({\n                        designer: true,\n                        player: true\n                      });\n\n                      console.log(\"logged as player and designer\");\n                    } else {\n                      console.log(\"error\");\n                      return;\n                    }\n\n                    _this.setState({\n                      isLogged: true,\n                      name: name,\n                      surname: surname,\n                      email: email\n                    });\n\n                    _this.setState({\n                      main: true\n                    });\n\n                    var designer = _this.state.designer;\n                    var player = _this.state.player;\n                    Cookies.set('name', name);\n                    Cookies.set('surname', surname);\n                    Cookies.set('email', email);\n                    Cookies.set('log', 'true');\n                    Cookies.set('main', 'true');\n                    Cookies.set('designer', designer);\n                    Cookies.set('player', player);\n                    console.log(response.data[0]);\n                  } else {\n                    _this.setState({\n                      invalidLogin: true\n                    });\n\n                    console.log(\"invalid login\");\n                  }\n                });\n\n              case 7:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFileL =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(event) {\n        var stri;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging username\");\n                stri = event.target.value;\n                _context6.next = 5;\n                return _this.setState({\n                  username: stri\n                });\n\n              case 5:\n                console.log(_this.state.username);\n\n              case 6:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFileL1 =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(event) {\n        var stri;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging password\");\n                stri = event.target.value;\n                _context7.next = 5;\n                return _this.setState({\n                  password: stri\n                });\n\n              case 5:\n                console.log(_this.state.password);\n\n              case 6:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFileL2 =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(event) {\n        var stri, check, check1;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging email\");\n                stri = event.target.value;\n                check = stri.includes(\"@\");\n                check1 = stri.includes(\".\");\n\n                if (!(check && check1)) {\n                  _context8.next = 13;\n                  break;\n                }\n\n                _context8.next = 8;\n                return _this.setState({\n                  invalidEmail: false\n                });\n\n              case 8:\n                _context8.next = 10;\n                return _this.setState({\n                  email: stri\n                });\n\n              case 10:\n                console.log(_this.state.email);\n                _context8.next = 16;\n                break;\n\n              case 13:\n                _context8.next = 15;\n                return _this.setState({\n                  invalidEmail: true\n                });\n\n              case 15:\n                console.log(\"invalidEmail\");\n\n              case 16:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFileL3 =\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee9(event) {\n        var stri;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging name\");\n                stri = event.target.value;\n                _context9.next = 5;\n                return _this.setState({\n                  name: stri\n                });\n\n              case 5:\n                console.log(_this.state.name);\n\n              case 6:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n\n      return function (_x5) {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFileL4 =\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee10(event) {\n        var stri;\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging surname\");\n                stri = event.target.value;\n                _context10.next = 5;\n                return _this.setState({\n                  surname: stri\n                });\n\n              case 5:\n                console.log(_this.state.surname);\n\n              case 6:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10);\n      }));\n\n      return function (_x6) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFileL5 =\n    /*#__PURE__*/\n    function () {\n      var _ref7 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee11(event) {\n        var stri;\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging confirm password\");\n                stri = event.target.value;\n                _context11.next = 5;\n                return _this.setState({\n                  confirmPassword: stri\n                });\n\n              case 5:\n                console.log(_this.state.confirmPassword);\n\n              case 6:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11);\n      }));\n\n      return function (_x7) {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n\n    _this.setRegister =\n    /*#__PURE__*/\n    function () {\n      var _ref8 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee12(event) {\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"register init\");\n                _context12.next = 4;\n                return _this.setState({\n                  register: true\n                });\n\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12);\n      }));\n\n      return function (_x8) {\n        return _ref8.apply(this, arguments);\n      };\n    }();\n\n    _this.Return =\n    /*#__PURE__*/\n    function () {\n      var _ref9 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee13(event) {\n        return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"register aborted\");\n                _context13.next = 4;\n                return _this.setState({\n                  register: false\n                });\n\n              case 4:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13);\n      }));\n\n      return function (_x9) {\n        return _ref9.apply(this, arguments);\n      };\n    }();\n\n    _this.sendData = function (event) {\n      event.preventDefault();\n      var valid = _this.state.invalidEmail;\n      if (valid) return;\n      console.log(\"sending data\");\n      var username = _this.state.username;\n      var password = _this.state.password;\n      var confirmPassword = _this.state.confirmPassword;\n\n      if (confirmPassword == password) {\n        var hpassword = keccak256(password).toString('hex');\n        var wallet = _this.state.account;\n        var email = _this.state.email;\n        var name = _this.state.name;\n        var surname = _this.state.surname;\n        var registrationType = _this.state.registrationType;\n        console.log(wallet);\n        axios.post('http://127.0.0.1:5000/api/post2', {\n          username: username,\n          password: hpassword,\n          wallet: wallet,\n          email: email,\n          name: name,\n          surname: surname,\n          registrationType: registrationType\n        }).then(\n        /*#__PURE__*/\n        function () {\n          var _ref10 = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee14(response) {\n            var toHex, web3, account, hash, _toHex, _web, _account, _hash;\n\n            return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n              while (1) {\n                switch (_context14.prev = _context14.next) {\n                  case 0:\n                    console.log(response.data);\n\n                    if (!(response.data == \"succes\")) {\n                      _context14.next = 32;\n                      break;\n                    }\n\n                    _context14.next = 4;\n                    return _this.setState({\n                      register: false\n                    });\n\n                  case 4:\n                    if (!(registrationType == \"player\")) {\n                      _context14.next = 16;\n                      break;\n                    }\n\n                    toHex = function toHex(str) {\n                      var hex = '';\n\n                      for (var i = 0; i < str.length; i++) {\n                        hex += '' + str.charCodeAt(i).toString(16);\n                      }\n\n                      return hex;\n                    };\n\n                    console.log(\"adding player phase\");\n                    web3 = window.web3;\n                    account = _this.state.account;\n                    console.log(account);\n                    hash = keccak256(account);\n                    console.log(hash);\n                    _context14.next = 14;\n                    return web3.eth.personal.sign(hash, account, function (err, res) {\n                      if (res) {\n                        console.log(\"try\", res);\n                        web3.eth.personal.ecRecover(hash, res).then(console.log);\n                      }\n\n                      _this.state.contract.methods.addPlayer(hash, res).send({\n                        from: account\n                      });\n\n                      if (err) {\n                        console.log(\"err\");\n                      }\n                    });\n\n                  case 14:\n                    _context14.next = 30;\n                    break;\n\n                  case 16:\n                    if (!(registrationType == \"both\")) {\n                      _context14.next = 28;\n                      break;\n                    }\n\n                    _toHex = function _toHex(str) {\n                      var hex = '';\n\n                      for (var i = 0; i < str.length; i++) {\n                        hex += '' + str.charCodeAt(i).toString(16);\n                      }\n\n                      return hex;\n                    };\n\n                    console.log(\"adding player phase (from both)\");\n                    _web = window.web3;\n                    _account = _this.state.account;\n                    console.log(_account);\n                    _hash = keccak256(_account);\n                    console.log(_hash);\n                    _context14.next = 26;\n                    return _web.eth.personal.sign(_hash, _account, function (err, res) {\n                      if (res) {\n                        console.log(\"try\", res);\n\n                        _web.eth.personal.ecRecover(_hash, res).then(console.log);\n                      }\n\n                      _this.state.contract.methods.addPlayer(_hash, res).send({\n                        from: _account\n                      });\n\n                      if (err) {\n                        console.log(\"err\");\n                      }\n                    });\n\n                  case 26:\n                    _context14.next = 30;\n                    break;\n\n                  case 28:\n                    console.log(\"error\");\n                    return _context14.abrupt(\"return\");\n\n                  case 30:\n                    _context14.next = 35;\n                    break;\n\n                  case 32:\n                    console.log(\"invalid registration\");\n\n                    _this.setState({\n                      invalidPassword: false\n                    });\n\n                    _this.setState({\n                      invalidRegistration: true\n                    });\n\n                  case 35:\n                  case \"end\":\n                    return _context14.stop();\n                }\n              }\n            }, _callee14);\n          }));\n\n          return function (_x10) {\n            return _ref10.apply(this, arguments);\n          };\n        }());\n      } else {\n        console.log(\"invalid password\");\n\n        _this.setState({\n          invalidRegistration: false\n        });\n\n        _this.setState({\n          invalidPassword: true\n        });\n\n        return;\n      }\n    };\n\n    _this.logoutU =\n    /*#__PURE__*/\n    function () {\n      var _ref11 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee15(event) {\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"logout\");\n                Cookies.remove('log');\n                Cookies.remove('announce');\n                Cookies.remove('name');\n                Cookies.remove('surname');\n                Cookies.remove('email');\n                Cookies.remove('designer');\n                Cookies.remove('player');\n                _context15.next = 11;\n                return _this.setState({\n                  isLogged: false\n                });\n\n              case 11:\n                _context15.next = 13;\n                return _this.setState({\n                  announce: false\n                });\n\n              case 13:\n                console.log(_this.state.isLogged);\n\n              case 14:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15);\n      }));\n\n      return function (_x11) {\n        return _ref11.apply(this, arguments);\n      };\n    }();\n\n    _this.registrationType =\n    /*#__PURE__*/\n    function () {\n      var _ref12 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee16(event) {\n        var registrationType;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"type registration selected\");\n                registrationType = event.target.value;\n                console.log(_this.state.registrationType);\n                console.log(event.target.value);\n                _context16.next = 7;\n                return _this.setState({\n                  registrationType: registrationType\n                });\n\n              case 7:\n                console.log(_this.state.registrationType);\n\n              case 8:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16);\n      }));\n\n      return function (_x12) {\n        return _ref12.apply(this, arguments);\n      };\n    }();\n\n    _this.toUpload =\n    /*#__PURE__*/\n    function () {\n      var _ref13 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee17(event) {\n        return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"to Upload a design\");\n                _context17.next = 4;\n                return _this.setState({\n                  announce: true\n                });\n\n              case 4:\n                _context17.next = 6;\n                return _this.setState({\n                  main: false\n                });\n\n              case 6:\n                Cookies.set('announce', 'true');\n                Cookies.remove('main');\n\n              case 8:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17);\n      }));\n\n      return function (_x13) {\n        return _ref13.apply(this, arguments);\n      };\n    }();\n\n    _this.logoutM =\n    /*#__PURE__*/\n    function () {\n      var _ref14 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee18(event) {\n        return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"logout\");\n                Cookies.remove('log');\n                Cookies.remove('main');\n                Cookies.remove('name');\n                Cookies.remove('surname');\n                Cookies.remove('email');\n                Cookies.remove('designer');\n                Cookies.remove('player');\n                _context18.next = 11;\n                return _this.setState({\n                  isLogged: false\n                });\n\n              case 11:\n                _context18.next = 13;\n                return _this.setState({\n                  main: false\n                });\n\n              case 13:\n                console.log(_this.state.isLogged);\n\n              case 14:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18);\n      }));\n\n      return function (_x14) {\n        return _ref14.apply(this, arguments);\n      };\n    }();\n\n    _this.toCurrentDesigns =\n    /*#__PURE__*/\n    function () {\n      var _ref15 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee19(event) {\n        return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"to current designs\");\n\n                _this.state.contract1.getPastEvents('newDesignAvailable', {\n                  fromBlock: 0,\n                  toBlock: 'latest'\n                }, function (error, result) {\n                  if (!error) {\n                    var result1 = result.map(function (a) {\n                      return a.returnValues;\n                    });\n                    console.log(result1);\n\n                    for (var i in result1) {\n                      console.log(\"decoding\");\n\n                      var tmp = _this.getIpfsHashFromBytes32(result1[i].fileHash);\n\n                      tmp = \"https://ipfs.infura.io/ipfs/\" + tmp;\n                      console.log(tmp);\n                      result1[i].fileHash = tmp;\n                    }\n\n                    _this.setState({\n                      avaibleDesign: result1\n                    });\n                  } else {\n                    console.log(error);\n                  }\n                });\n\n                _context19.next = 5;\n                return _this.setState({\n                  currentDesigns: true\n                });\n\n              case 5:\n                _context19.next = 7;\n                return _this.setState({\n                  main: false\n                });\n\n              case 7:\n                Cookies.set('currentDesigns', 'true');\n                Cookies.remove('main');\n\n              case 9:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19);\n      }));\n\n      return function (_x15) {\n        return _ref15.apply(this, arguments);\n      };\n    }();\n\n    _this.toMainC =\n    /*#__PURE__*/\n    function () {\n      var _ref16 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee20(event) {\n        return _regeneratorRuntime.wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"to Main\");\n                Cookies.remove('currentDesigns');\n                _context20.next = 5;\n                return _this.setState({\n                  currentDesigns: false\n                });\n\n              case 5:\n                _context20.next = 7;\n                return _this.setState({\n                  main: true\n                });\n\n              case 7:\n                Cookies.set('main', 'true');\n\n              case 8:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20);\n      }));\n\n      return function (_x16) {\n        return _ref16.apply(this, arguments);\n      };\n    }();\n\n    _this.setCommit = function (event, maskedvalue, floatvalue) {\n      _this.setState({\n        amount: floatvalue\n      });\n\n      console.log(floatvalue);\n    };\n\n    _this.formatSelect =\n    /*#__PURE__*/\n    function () {\n      var _ref17 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee21(event) {\n        var designFormat;\n        return _regeneratorRuntime.wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"format selected\");\n                designFormat = event.target.value;\n                console.log(_this.state.designFormat);\n                console.log(event.target.value);\n                _context21.next = 7;\n                return _this.setState({\n                  designFormat: designFormat\n                });\n\n              case 7:\n                console.log(_this.state.designFormat);\n\n              case 8:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21);\n      }));\n\n      return function (_x17) {\n        return _ref17.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFile = function (event) {\n      event.preventDefault();\n      var file = event.target.files[0]; //var stl = new NodeStl( file, {density: 1.04});\n      //  console.log(stl.volume);\n\n      var format = _this.state.designFormat;\n\n      if (format == \"stl\") {\n        _this.setState({\n          stlFile: file\n        });\n\n        _this.setState({\n          disableObj: false\n        });\n\n        _this.setState({\n          disableStl: true\n        });\n\n        console.log(_this.state.stlFile);\n      } else {\n        if (format == 'obj') {\n          _this.setState({\n            objFile: file\n          });\n\n          _this.setState({\n            disableStl: false\n          });\n\n          _this.setState({\n            disableObj: true\n          });\n\n          console.log(_this.state.objFile);\n        } else {\n          console.log(\"format not selected\");\n        }\n      }\n\n      var reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onloadend = function () {\n        _this.setState({\n          buffer: Buffer(reader.result)\n        });\n\n        console.log('buffer', _this.state.buffer);\n      };\n    };\n\n    _this.captureFile2 =\n    /*#__PURE__*/\n    function () {\n      var _ref18 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee22(event) {\n        var stri;\n        return _regeneratorRuntime.wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging designName\");\n                stri = event.target.value;\n                _context22.next = 5;\n                return _this.setState({\n                  designName: stri\n                });\n\n              case 5:\n                console.log(_this.state.designName);\n\n              case 6:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22);\n      }));\n\n      return function (_x18) {\n        return _ref18.apply(this, arguments);\n      };\n    }();\n\n    _this.captureFile5 =\n    /*#__PURE__*/\n    function () {\n      var _ref19 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee23(event) {\n        var stri;\n        return _regeneratorRuntime.wrap(function _callee23$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"charging design description\");\n                stri = event.target.value;\n                _context23.next = 5;\n                return _this.setState({\n                  desc: stri\n                });\n\n              case 5:\n                console.log(_this.state.desc);\n\n              case 6:\n              case \"end\":\n                return _context23.stop();\n            }\n          }\n        }, _callee23);\n      }));\n\n      return function (_x19) {\n        return _ref19.apply(this, arguments);\n      };\n    }();\n\n    _this.onSubmit =\n    /*#__PURE__*/\n    function () {\n      var _ref20 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee25(event) {\n        return _regeneratorRuntime.wrap(function _callee25$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n                event.preventDefault();\n                _context25.next = 3;\n                return ipfs.add(_this.state.buffer,\n                /*#__PURE__*/\n                function () {\n                  var _ref21 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee24(error, result) {\n                    var designName, desc, makerName, makerSurname, designHash, toJSON, myJson, buf;\n                    return _regeneratorRuntime.wrap(function _callee24$(_context24) {\n                      while (1) {\n                        switch (_context24.prev = _context24.next) {\n                          case 0:\n                            console.log('Ipfs result', result);\n\n                            if (!error) {\n                              _context24.next = 4;\n                              break;\n                            }\n\n                            console.error(error);\n                            return _context24.abrupt(\"return\");\n\n                          case 4:\n                            console.log(result);\n\n                            _this.setState({\n                              designHash: result[0].hash\n                            });\n\n                            console.log(\"Submitting data to ipfs\");\n                            designName = _this.state.designName;\n                            desc = _this.state.desc;\n                            makerName = _this.state.name;\n                            makerSurname = _this.state.surname;\n                            designHash = _this.state.designHash;\n\n                            if (!(designName == '' || makerName == '' || makerSurname == '' || desc == '')) {\n                              _context24.next = 18;\n                              break;\n                            }\n\n                            console.log(\"metadata not saved\");\n\n                            _this.setState({\n                              designName: '',\n                              makerName: '',\n                              makerSurname: '',\n                              desc: ''\n                            });\n\n                            return _context24.abrupt(\"return\");\n\n                          case 18:\n                            if (designHash == '') {\n                              console.log(\"design not uploaded\");\n                            } else {\n                              toJSON = {\n                                designName: designName,\n                                makerName: makerName,\n                                makerSurname: makerSurname,\n                                desc: desc,\n                                designHash: designHash\n                              };\n                              myJson = JSON.stringify(toJSON);\n                              console.log(toJSON);\n                              console.log(myJson);\n                              buf = Buffer.from(myJson);\n                              ipfs.add(buf, function (error, result) {\n                                console.log('Ipfs result', result);\n\n                                if (error) {\n                                  console.error(error);\n                                  return;\n                                }\n\n                                console.log(result[0].hash);\n                              });\n\n                              _this.setState({\n                                designName: '',\n                                makerName: '',\n                                makerSurname: '',\n                                desc: ''\n                              });\n                            }\n\n                          case 19:\n                            _this.state.contract.methods.getExpiry().call({\n                              from: _this.state.account\n                            }).then(function (res) {\n                              var hash = _this.state.designHash;\n                              console.log(\"inizio conv\");\n\n                              var fhash = _this.getBytes32FromIpfsHash(hash);\n\n                              var web3 = window.web3;\n                              console.log(\"solo fixedhash\", fhash);\n                              console.log(_this.state.contract);\n                              console.log(res);\n                              var currentTimeInSeconds = Math.floor(Date.now() / 1000);\n                              console.log(currentTimeInSeconds);\n                              var amount1 = _this.state.amount;\n                              console.log(amount1);\n                              var amount = web3.utils.toWei(amount1.toString(), 'ether');\n                              console.log(amount);\n                              var manager = \"0xeFC24d39428360E526D467d219Ce85F0d9B71b8e\";\n                              console.log('start smart contract call');\n\n                              _this.state.contract.methods.announce(fhash, currentTimeInSeconds, res, amount, manager).send({\n                                from: _this.state.account,\n                                value: amount\n                              }).on('transactionHash', function (hash) {\n                                console.log(\"Hash: \" + hash);\n                              }).on('error', console.error).on('confirmation', function (confirmationNumber, receipt) {\n                                console.log(receipt);\n                              }).on('receipt', function (receipt) {\n                                console.log(\"provareceipt\");\n                              });\n                            });\n\n                          case 20:\n                          case \"end\":\n                            return _context24.stop();\n                        }\n                      }\n                    }, _callee24);\n                  }));\n\n                  return function (_x21, _x22) {\n                    return _ref21.apply(this, arguments);\n                  };\n                }());\n\n              case 3:\n              case \"end\":\n                return _context25.stop();\n            }\n          }\n        }, _callee25);\n      }));\n\n      return function (_x20) {\n        return _ref20.apply(this, arguments);\n      };\n    }();\n\n    _this.toMainU =\n    /*#__PURE__*/\n    function () {\n      var _ref22 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee26(event) {\n        return _regeneratorRuntime.wrap(function _callee26$(_context26) {\n          while (1) {\n            switch (_context26.prev = _context26.next) {\n              case 0:\n                event.preventDefault();\n                console.log(\"to Main\");\n                Cookies.remove('announce');\n                _context26.next = 5;\n                return _this.setState({\n                  announce: false\n                });\n\n              case 5:\n                _context26.next = 7;\n                return _this.setState({\n                  main: true\n                });\n\n              case 7:\n                Cookies.set('main', 'true');\n                console.log(_this.state.announce);\n\n              case 9:\n              case \"end\":\n                return _context26.stop();\n            }\n          }\n        }, _callee26);\n      }));\n\n      return function (_x23) {\n        return _ref22.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      contract1: null,\n      designHash: '',\n      contract: null,\n      web3: null,\n      buffer: null,\n      account: null,\n      designName: '',\n      desc: '',\n      stlLink: null,\n      objLink: null,\n      designFormat: 'stl',\n      username: '',\n      password: '',\n      confirmPassword: '',\n      //    wallet:'',\n      privateKey: '',\n      email: '',\n      register: false,\n      ethBrowser: false,\n      invalidEmail: false,\n      name: '',\n      surname: '',\n      isLogged: false,\n      invalidLogin: false,\n      disableStl: true,\n      disableObj: true,\n      announce: false,\n      main: false,\n      loading: true,\n      file: null,\n      amount: \"0.00\",\n      expiry: \"0\",\n      registrationType: 'designer',\n      designer: false,\n      player: false,\n      avaibleDesign: [],\n      currentDesigns: false,\n      invalidRegistration: false,\n      invalidPassword: false\n    };\n    return _this;\n  } //login part\n\n\n  _createClass(App, [{\n    key: \"render\",\n    // end announce part\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 633\n        },\n        __self: this\n      }, React.createElement(\"nav\", {\n        className: \"navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 634\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        className: \"navbar-brand col-sm-3 col-md-2 mr-0\",\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 635\n        },\n        __self: this\n      }, \"App di prova\")), React.createElement(\"div\", {\n        className: \"container-fluid mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 643\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 644\n        },\n        __self: this\n      }, React.createElement(\"main\", {\n        role: \"main\",\n        className: \"col-lg-12 d-flex text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 645\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"content mr-auto ml-auto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 646\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 647\n        },\n        __self: this\n      }), this.state.loading && React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 654\n        },\n        __self: this\n      }, \"Loading\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 658\n        },\n        __self: this\n      }, !this.state.isLogged && !this.state.loading && !this.state.register && React.createElement(\"h1\", {\n        id: \"param1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 659\n        },\n        __self: this\n      }, \"Login Page\"), !this.state.isLogged && !this.state.loading && this.state.register && React.createElement(\"h1\", {\n        id: \"param16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 660\n        },\n        __self: this\n      }, \"Register Page\"), React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 662\n        },\n        __self: this\n      }, this.state.ethBrowser && !this.state.isLogged && !this.state.loading && React.createElement(\"label\", {\n        id: \"param2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 663\n        },\n        __self: this\n      }, \"username:\", React.createElement(\"input\", {\n        type: \"text\",\n        onChange: this.captureFileL,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 665\n        },\n        __self: this\n      }))), this.state.ethBrowser && !this.state.isLogged && !this.state.loading && React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 668\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        id: \"param3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 669\n        },\n        __self: this\n      }, \"password:\", React.createElement(\"input\", {\n        type: \"password\",\n        onChange: this.captureFileL1,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 671\n        },\n        __self: this\n      }))), this.state.ethBrowser && !this.state.isLogged && !this.state.loading && this.state.register && React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 674\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        id: \"param17\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 675\n        },\n        __self: this\n      }, \"confirm password:\", React.createElement(\"input\", {\n        type: \"password\",\n        onChange: this.captureFileL5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 677\n        },\n        __self: this\n      }))), this.state.invalidLogin && !this.state.isLogged && this.state.ethBrowser && !this.state.loading && React.createElement(\"div\", {\n        id: \"param6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 680\n        },\n        __self: this\n      }, \"invalid username/password\"), this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading ? React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 683\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        id: \"param7\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 684\n        },\n        __self: this\n      }, \"name:\", React.createElement(\"input\", {\n        type: \"text\",\n        onChange: this.captureFileL3,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 686\n        },\n        __self: this\n      }))) : null, this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading ? React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 691\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        id: \"param8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 692\n        },\n        __self: this\n      }, \"surname:\", React.createElement(\"input\", {\n        type: \"text\",\n        onChange: this.captureFileL4,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 694\n        },\n        __self: this\n      }))) : null, this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading ? React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 699\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        id: \"param9\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 700\n        },\n        __self: this\n      }, \"email:\", React.createElement(\"input\", {\n        type: \"text\",\n        onChange: this.captureFileL2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 702\n        },\n        __self: this\n      }))) : null, this.state.register && this.state.ethBrowser && this.state.invalidEmail && !this.state.isLogged && !this.state.loading && React.createElement(\"div\", {\n        id: \"param10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 707\n        },\n        __self: this\n      }, \"invalid email\"), !this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading && React.createElement(\"button\", {\n        className: \"button\",\n        id: \"param4\",\n        onClick: this.startApi2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 711\n        },\n        __self: this\n      }, \"Login\"), !this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading && React.createElement(\"button\", {\n        className: \"button\",\n        id: \"param5\",\n        onClick: this.setRegister,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 715\n        },\n        __self: this\n      }, \"Register\"), this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading && React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 718\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        id: \"param14\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 719\n        },\n        __self: this\n      }, \"Registration Type:\", React.createElement(\"select\", {\n        onChange: this.registrationType,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 721\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"designer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 722\n        },\n        __self: this\n      }, \"designer\"), React.createElement(\"option\", {\n        value: \"player\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 723\n        },\n        __self: this\n      }, \"player\"), React.createElement(\"option\", {\n        value: \"both\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 724\n        },\n        __self: this\n      }, \"both\")))), this.state.register && this.state.ethBrowser && this.state.invalidRegistration && !this.state.isLogged && !this.state.loading && React.createElement(\"div\", {\n        id: \"param15\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 729\n        },\n        __self: this\n      }, \"Username or wallet already registered\"), this.state.register && this.state.ethBrowser && this.state.invalidPassword && !this.state.isLogged && !this.state.loading && React.createElement(\"div\", {\n        id: \"param18\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 732\n        },\n        __self: this\n      }, \"Password and Confirm Password are different\"), this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading && React.createElement(\"button\", {\n        className: \"button\",\n        id: \"param11\",\n        onClick: this.sendData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 735\n        },\n        __self: this\n      }, \"SendData\"), this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading && React.createElement(\"button\", {\n        className: \"button\",\n        id: \"param12\",\n        onClick: this.Return,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 739\n        },\n        __self: this\n      }, \"Return\"), !this.state.ethBrowser && !this.state.isLogged && !this.state.loading && !this.state.loading && React.createElement(\"div\", {\n        id: \"param13\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 744\n        },\n        __self: this\n      }, \"Non-Ethereum browser detected, please install metamask.\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 744\n        },\n        __self: this\n      }), \"[.....metamask tutorial \", React.createElement(\"a\", {\n        id: \"para\",\n        href: 'https://metamask.io/download.html',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 745\n        },\n        __self: this\n      }, \"here\"), \"...]\")), this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading && React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 759\n        },\n        __self: this\n      }, \"User data\", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 759\n        },\n        __self: this\n      }), \"name:\", this.state.name, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 759\n        },\n        __self: this\n      }), \"surname:\", this.state.surname, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 759\n        },\n        __self: this\n      }), \"email:\", this.state.email, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 759\n        },\n        __self: this\n      }), \"wallet:\", this.state.account), this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading && this.state.designer && React.createElement(\"button\", {\n        className: \"button\",\n        onClick: this.toUpload,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 762\n        },\n        __self: this\n      }, \"Upload a design\"), this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading && React.createElement(\"button\", {\n        className: \"button\",\n        onClick: this.logoutU,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 765\n        },\n        __self: this\n      }, \"Logout\"), this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading && this.state.player && React.createElement(\"button\", {\n        className: \"button\",\n        onClick: this.toCurrentDesigns,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 768\n        },\n        __self: this\n      }, \"List avaible design to vote\"), this.state.ethBrowser && this.state.isLogged && !this.state.loading && this.state.player && this.state.currentDesigns && React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 777\n        },\n        __self: this\n      }, React.createElement(\"table\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 778\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 778\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 778\n        },\n        __self: this\n      }, \"designNo\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 778\n        },\n        __self: this\n      }, \"creatorAddress\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 778\n        },\n        __self: this\n      }, \"design\")), this.state.avaibleDesign.map(function (item) {\n        return React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 778\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 778\n          },\n          __self: this\n        }, item.designNo.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 778\n          },\n          __self: this\n        }, item.creator.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 778\n          },\n          __self: this\n        }, item.fileHash.toString()));\n      }))), this.state.ethBrowser && this.state.isLogged && !this.state.loading && this.state.player && this.state.currentDesigns && React.createElement(\"button\", {\n        className: \"button\",\n        onClick: this.toMainC,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 781\n        },\n        __self: this\n      }, \"Return\"), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 789\n        },\n        __self: this\n      }, \"Design caricato:\"), this.state.ethBrowser && this.state.isLogged && this.state.disableStl && this.state.announce && !this.state.loading && this.state.stlFile && this.state.designer ? React.createElement(STLViewer, {\n        onSceneRendered: function onSceneRendered(element) {\n          console.log(element);\n        },\n        sceneClassName: \"test-scene\",\n        file: this.state.stlFile,\n        className: \"obj\",\n        modelColor: \"#FF0000\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 791\n        },\n        __self: this\n      }) : null, this.state.ethBrowser && this.state.isLogged && this.state.disableObj && this.state.announce && !this.state.loading && this.state.objFile && this.state.designer ? React.createElement(OBJViewer, {\n        onSceneRendered: function onSceneRendered(element) {\n          console.log(element);\n        },\n        sceneClassName: \"test-scene\",\n        file: this.state.objFile,\n        className: \"obj\",\n        modelColor: \"#FF0000\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 802\n        },\n        __self: this\n      }) : null, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 812\n        },\n        __self: this\n      }, \"\\xA0\"), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 813\n        },\n        __self: this\n      }, \"Change design\"), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 814\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"file\",\n        onChange: this.captureFile,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 815\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 816\n        },\n        __self: this\n      }, \"\\xA0\")), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 818\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 819\n        },\n        __self: this\n      }, \"\\xA0\"), React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 820\n        },\n        __self: this\n      }, \"Design title:\", React.createElement(\"input\", {\n        type: \"text\",\n        onChange: this.captureFile2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 822\n        },\n        __self: this\n      }))), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"form\", {\n        onSubmit: this.captureFile2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 825\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 826\n        },\n        __self: this\n      }, \"Design description:\", React.createElement(\"textarea\", {\n        onChange: this.captureFile5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 828\n        },\n        __self: this\n      }))), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 831\n        },\n        __self: this\n      }, \"amount:\", React.createElement(CurrencyInput, {\n        value: this.state.amount,\n        onChangeEvent: this.setCommit,\n        CurrencyInput: true,\n        suffix: \" ETH\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 833\n        },\n        __self: this\n      })), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"button\", {\n        class: \"button\",\n        onClick: this.onSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 836\n        },\n        __self: this\n      }, \"Submit\"), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 837\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 838\n        },\n        __self: this\n      }, \"Select design format:\", React.createElement(\"select\", {\n        onChange: this.formatSelect,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 840\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"stl\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 841\n        },\n        __self: this\n      }, \".stl\"), React.createElement(\"option\", {\n        value: \"obj\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 842\n        },\n        __self: this\n      }, \".obj\")))), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"button\", {\n        className: \"button\",\n        onClick: this.logoutU,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 847\n        },\n        __self: this\n      }, \"Logout\"), this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer && React.createElement(\"button\", {\n        className: \"button\",\n        onClick: this.toMainU,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 850\n        },\n        __self: this\n      }, \"Return\"))))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/home/costantinos/Documenti/Dapp/src/components/App.js"],"names":["React","Component","Web3","ReactDOM","Dapp","OBJViewer","STLViewer","axios","Cookies","designVoting","ethers","bs58","CurrencyInput","keccak256","NodeStl","require","ipfsClient","ipfs","host","port","protocol","web3s","providers","WebsocketProvider","App","loadWeb3","state","ethBrowser","loadBlockchainData","subscriptionEvents","cookiesLog","setState","loading","isLogged","get","inMain","inAnn","name","surname","email","designer","player","currentDesigns","main","announce","toCurrentDesigns","contract1","events","newDesignAvailable","error","event","console","log","on","newPlayerAddition","window","ethereum","web3","enable","currentProvider","eth","getAccounts","accounts","account","net","getId","networkId","networkData","networks","contract","Contract","abi","address","alert","_ipfsListing","decode","slice","toString","bytes32Hex","hashHex","hashBytes","Buffer","from","hashStr","encode","props","testMeta","preventDefault","try1","create","startApi","then","response","data","startApi2","username","password","hpassword","wallet","post","length","registrationType","set","invalidLogin","captureFileL","stri","target","value","captureFileL1","captureFileL2","check","includes","check1","invalidEmail","captureFileL3","captureFileL4","captureFileL5","confirmPassword","setRegister","register","Return","sendData","valid","toHex","str","hex","i","charCodeAt","hash","personal","sign","err","res","ecRecover","methods","addPlayer","send","invalidPassword","invalidRegistration","logoutU","remove","toUpload","logoutM","getPastEvents","fromBlock","toBlock","result","result1","map","a","returnValues","tmp","getIpfsHashFromBytes32","fileHash","avaibleDesign","toMainC","setCommit","maskedvalue","floatvalue","amount","formatSelect","designFormat","captureFile","file","files","format","stlFile","disableObj","disableStl","objFile","reader","FileReader","readAsArrayBuffer","onloadend","buffer","captureFile2","designName","captureFile5","desc","onSubmit","add","designHash","makerName","makerSurname","toJSON","myJson","JSON","stringify","buf","getExpiry","call","fhash","getBytes32FromIpfsHash","currentTimeInSeconds","Math","floor","Date","now","amount1","utils","toWei","manager","confirmationNumber","receipt","toMainU","stlLink","objLink","privateKey","expiry","item","designNo","creator","element"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Web3 from 'web3';\nimport './App.css';\nimport ReactDOM from 'react-dom';\nimport Dapp from '../abis/Dapp.json'\nimport {OBJViewer, STLViewer} from 'react-stl-obj-viewer';\nimport axios from 'axios'\nimport Cookies from 'js-cookie'\nimport designVoting from '../abis/designVoting.json'\nimport { ethers } from \"ethers\";\nimport bs58 from 'bs58'\nimport CurrencyInput from 'react-currency-input';\nimport { keccak256 } from 'js-sha3';\nconst NodeStl = require(\"node-stl\");\n\n\n//connessione al nodo di infura per ipfs\nconst ipfsClient = require('ipfs-http-client')\nconst ipfs = ipfsClient({ host: 'ipfs.infura.io', port: 5001, protocol: 'https' })\n  let web3s = new Web3(new Web3.providers.WebsocketProvider('ws://localhost:7546'))\n//tipi di formato .stl (più comune) 3MF AMF e .obj(open source)\n// usa accept\n// url example:'https://ipfs.infura.io/ipfs/QmZsdEtccredWWGZzZvU5fStsC7aWADJch588qAarGTky9'\n//{`https://ipfs.infura.io/ipfs/${this.state.designHash}`}\n//const user = []\n\nclass App extends Component {\n\n\n//operazioni quando il componente viene chiamato\n  async componentWillMount() {\n    await this.loadWeb3()\n  if(this.state.ethBrowser == true) {\n    await this.loadBlockchainData()\n      await this.subscriptionEvents()\n      await this.cookiesLog()\n      await this.setState({loading : false})\n  }\n  }\n  async cookiesLog(){\n    const isLogged = Cookies.get('log')\n    const inMain = Cookies.get('main')\n    const inAnn = Cookies.get('announce')\n    const name = Cookies.get('name')\n    const surname = Cookies.get('surname')\n    const email = Cookies.get('email')\n    const designer = Cookies.get('designer')\n    const player = Cookies.get('player')\n    const currentDesigns = Cookies.get('currentDesigns')\n    if(isLogged) await this.setState({isLogged : isLogged})\n    if(inMain) await this.setState({main : inMain})\n    if(inAnn) await this.setState({announce : inAnn})\n    if(name) await this.setState({name : name})\n    if(surname) await this.setState({surname : surname})\n    if(email) await this.setState({email : email})\n    if(designer) await this.setState({designer : designer})\n    if(player) await this.setState({player : player})\n    if(currentDesigns) await this.setState({toCurrentDesigns : currentDesigns})\n  }\n  subscriptionEvents(){\n    this.state.contract1.events.newDesignAvailable( function(error, event){ console.log(event); }).on('data', function(event){\n     console.log(event); // same results as the optional callback above\n }).on('changed', function(event){\n     // remove event from local database\n }).on('error', console.error);\n this.state.contract1.events.newPlayerAddition( function(error, event){ console.log(event); }).on('data', function(event){\n  console.log(event); // same results as the optional callback above\n}).on('changed', function(event){\n  // remove event from local database\n}).on('error', console.error);\n  }\n//carico la finestra (metamask) web3 o la converto in web3\n  async loadWeb3() {\n   if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum)\n      await window.ethereum.enable()\n      await this.setState({ethBrowser : true})\n    }\n    else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider)\n      await this.setState({ethBrowser : true})\n    }\n    else {\n      console.log('Non-Ethereum browser detected. ')\n      await this.setState({ethBrowser : false})\n      await this.setState({loading : false})\n      return\n    }\n  }\n// dati della blockchain:\n//account è l'indirizzo di colui che firma la transazione\n//networkid è l'id della connessione es:localhost:7545\n//contract è la variabile del contratto\n//designHash è l'hash del file salvato sull'ipfs\n  async loadBlockchainData() {\n    const web3 = window.web3\n    const accounts = await web3.eth.getAccounts()\n    this.setState({ account: accounts[0] })\n    console.log(accounts)\n    const networkId = await web3.eth.net.getId()\n    console.log(networkId)\n    const networkData = designVoting.networks[networkId]\n    console.log(networkData)\n    if(networkData) {\n      const contract = web3.eth.Contract(designVoting.abi, networkData.address)\n      const contract1 = web3s.eth.Contract(designVoting.abi, networkData.address)\n      this.setState({ contract : contract, contract1 : contract1 })\n    } else {\n      window.alert('Smart contract not deployed to detected network.')\n    }\n  }\n  getBytes32FromIpfsHash(_ipfsListing) {\n    return \"0x\"+bs58.decode(_ipfsListing).slice(2).toString('hex')\n  }\n  getIpfsHashFromBytes32(bytes32Hex) {\n    const hashHex = \"1220\" + bytes32Hex.slice(2)\n    const hashBytes = Buffer.from(hashHex, 'hex');\n    const hashStr = bs58.encode(hashBytes)\n    return hashStr\n  }\n\n\n\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      contract1: null,\n      designHash: '',\n      contract: null,\n      web3: null,\n      buffer: null,\n      account: null,\n      designName: '',\n      desc:'',\n      stlLink: null,\n      objLink: null,\n      designFormat : 'stl',\n      username:'',\n      password:'',\n      confirmPassword:'',\n  //    wallet:'',\n      privateKey:'',\n      email:'',\n      register : false,\n      ethBrowser : false,\n      invalidEmail : false,\n      name : '',\n      surname : '',\n      isLogged : false,\n      invalidLogin : false,\n      disableStl : true,\n      disableObj : true,\n      announce : false,\n      main : false,\n      loading : true,\n      file : null,\n      amount : \"0.00\",\n      expiry : \"0\",\n      registrationType : 'designer',\n      designer : false,\n      player : false,\n      avaibleDesign : [],\n      currentDesigns : false,\n      invalidRegistration : false,\n      invalidPassword : false\n    }\n  }\n\n\n\n\n\n//login part\ntestMeta = (event) =>{\n  event.preventDefault()\n  const web3 = window.web3\n  const try1 =  web3.eth.accounts.create();\n console.log(try1)\n}\nstartApi =  (event) =>{\n  event.preventDefault()\n  axios.get('http://127.0.0.1:5000/api/get1').then(response => {\n  console.log(response.data)\n});\n}\nstartApi2 = async (event) =>{\n  event.preventDefault()\n  console.log(\"sending data\")\n  const username = this.state.username\n  const password = this.state.password\n  const hpassword = keccak256(password).toString('hex')\n  const wallet = this.state.account\n  axios.post('http://127.0.0.1:5000/api/post1',{\n    username : username,\n    password : hpassword,\n    wallet : wallet\n  }).then(response => {\n  if (response.data.length == 1) {\n    const name = response.data[0][3]\n    const surname = response.data[0][4]\n    const email = response.data[0][6]\n    const registrationType = response.data[0][7]\n    if(registrationType == \"designer\") {\n      this.setState({designer : true})\n      console.log(\"logged as designer\")\n    }\n    else if (registrationType == \"player\") {\n      this.setState({player : true})\n      console.log(\"logged as player\")\n    }\n    else if (registrationType == \"both\") {\n      this.setState({designer : true, player : true})\n      console.log(\"logged as player and designer\")\n    }\n    else {\n      console.log(\"error\")\n      return\n    }\n    this.setState({isLogged : true ,name : name, surname : surname, email: email})\n    this.setState({main : true})\n    const designer = this.state.designer\n    const player = this.state.player\n    Cookies.set('name', name)\n    Cookies.set('surname', surname)\n    Cookies.set('email', email)\n    Cookies.set('log', 'true')\n    Cookies.set('main','true')\n    Cookies.set('designer', designer)\n    Cookies.set('player', player)\n    console.log(response.data[0])\n  }\n  else {\n    this.setState({invalidLogin : true})\n    console.log(\"invalid login\")\n  }\n});\n}\n\ncaptureFileL = async (event)=> {\n  event.preventDefault()\n  console.log(\"charging username\")\n  const stri = event.target.value\n  await this.setState({ username: stri })\n  console.log(this.state.username)\n}\ncaptureFileL1 = async (event)=> {\n  event.preventDefault()\n  console.log(\"charging password\")\n  const stri = event.target.value\n  await this.setState({ password: stri })\n  console.log(this.state.password)\n}\ncaptureFileL2 = async (event)=> {\n  event.preventDefault()\n  console.log(\"charging email\")\n  const stri = event.target.value\n  var check = stri.includes(\"@\")\n  var check1 = stri.includes(\".\")\n  if(check && check1) {\n  await this.setState({invalidEmail : false})\n  await this.setState({ email: stri })\n  console.log(this.state.email)}\n  else {\n    await this.setState({invalidEmail : true })\n    console.log(\"invalidEmail\")\n  }\n}\n\ncaptureFileL3 = async (event)=> {\n  event.preventDefault()\n  console.log(\"charging name\")\n  const stri = event.target.value\n  await this.setState({ name: stri })\n  console.log(this.state.name)\n}\ncaptureFileL4 = async (event)=> {\n  event.preventDefault()\n  console.log(\"charging surname\")\n  const stri = event.target.value\n  await this.setState({ surname: stri })\n  console.log(this.state.surname)\n}\ncaptureFileL5 = async (event)=> {\n  event.preventDefault()\n  console.log(\"charging confirm password\")\n  const stri = event.target.value\n  await this.setState({ confirmPassword: stri })\n  console.log(this.state.confirmPassword)\n}\nsetRegister = async (event) => {\n  event.preventDefault()\n  console.log(\"register init\")\n  await this.setState({register : true})\n}\nReturn = async (event) => {\n  event.preventDefault()\n  console.log(\"register aborted\")\n  await this.setState({register : false})\n}\nsendData =  (event) => {\n  event.preventDefault()\n  const valid = this.state.invalidEmail\n  if (valid) return\n  console.log(\"sending data\")\n  const username = this.state.username\n  const password = this.state.password\n  const confirmPassword = this.state.confirmPassword\n  if(confirmPassword == password)\n  {const hpassword = keccak256(password).toString('hex')\n  const wallet = this.state.account\n  const email = this.state.email\n  const name = this.state.name\n  const surname = this.state.surname\n  const registrationType = this.state.registrationType\n  console.log(wallet)\n  axios.post('http://127.0.0.1:5000/api/post2',{\n    username : username,\n    password : hpassword,\n    wallet : wallet,\n    email : email,\n    name : name,\n    surname : surname,\n    registrationType : registrationType\n  }).then(async (response) => {\n  console.log(response.data)\n if(response.data == \"succes\")\n  {await this.setState({register : false})\n  if (registrationType == \"player\") {\n    console.log(\"adding player phase\")\n    const web3 = window.web3\n    function toHex(str) {\n     var hex = ''\n     for(var i=0;i<str.length;i++) {\n      hex += ''+str.charCodeAt(i).toString(16)\n     }\n     return hex\n    }\n    const account = this.state.account\n    console.log(account)\n    const hash = keccak256(account);\n    console.log(hash)\n     await web3.eth.personal.sign(hash, account ,(err,res) =>{\n      if(res){\n      console.log(\"try\", res)\n      web3.eth.personal.ecRecover(hash, res).then(console.log)}\n    this.state.contract.methods.addPlayer(hash, res).send({from : account})\n    if(err){console.log(\"err\")}\n    })\n  }\n  else if (registrationType == \"both\") {\n    console.log(\"adding player phase (from both)\")\n    const web3 = window.web3\n    function toHex(str) {\n     var hex = ''\n     for(var i=0;i<str.length;i++) {\n      hex += ''+str.charCodeAt(i).toString(16)\n     }\n     return hex\n    }\n    const account = this.state.account\n    console.log(account)\n    const hash = keccak256(account);\n    console.log(hash)\n    await web3.eth.personal.sign(hash, account ,(err,res) =>{\n     if(res){\n     console.log(\"try\", res)\n     web3.eth.personal.ecRecover(hash, res).then(console.log)}\n   this.state.contract.methods.addPlayer(hash, res).send({from : account})\n   if(err){console.log(\"err\")}\n   })\n  }\n  else {\n    console.log(\"error\")\n    return\n  }\n}else{\n  console.log(\"invalid registration\")\n  this.setState({invalidPassword : false})\n  this.setState({invalidRegistration : true})\n}\n});}\nelse{\n    console.log(\"invalid password\")\n    this.setState({invalidRegistration : false})\n    this.setState({invalidPassword : true})\n    return\n}\n}\nlogoutU = async (event) => {\n  event.preventDefault()\n  console.log(\"logout\")\n  Cookies.remove('log')\n  Cookies.remove('announce')\n  Cookies.remove('name')\n  Cookies.remove('surname')\n  Cookies.remove('email')\n  Cookies.remove('designer')\n  Cookies.remove('player')\n  await this.setState({isLogged : false})\n  await this.setState({announce : false})\n  console.log(this.state.isLogged)\n}\nregistrationType = async (event) => {\n  event.preventDefault()\n  console.log(\"type registration selected\")\n  const registrationType =  event.target.value\n  console.log(this.state.registrationType)\n  console.log(event.target.value)\n  await  this.setState({registrationType : registrationType })\n  console.log(this.state.registrationType)\n}\n//end login part\n\n\n//main part\ntoUpload = async (event) =>{\n  event.preventDefault()\n  console.log(\"to Upload a design\")\n  await this.setState({announce : true})\n  await this.setState({main : false})\n  Cookies.set('announce','true')\n  Cookies.remove('main')\n}\nlogoutM = async (event) => {\n  event.preventDefault()\n  console.log(\"logout\")\n  Cookies.remove('log')\n  Cookies.remove('main')\n  Cookies.remove('name')\n  Cookies.remove('surname')\n  Cookies.remove('email')\n  Cookies.remove('designer')\n  Cookies.remove('player')\n  await this.setState({isLogged : false})\n  await this.setState({main : false})\n  console.log(this.state.isLogged)\n}\ntoCurrentDesigns = async (event) =>{\n  event.preventDefault()\n  console.log(\"to current designs\")\n  this.state.contract1.getPastEvents('newDesignAvailable', {\n      fromBlock: 0,\n      toBlock: 'latest'\n    }, (error, result) =>{\n      if (!error) {\n        let result1 = result.map(a => a.returnValues);\n        console.log(result1)\n        for(var i in result1){\n          console.log(\"decoding\")\n          var tmp = this.getIpfsHashFromBytes32(result1[i].fileHash)\n          tmp = \"https://ipfs.infura.io/ipfs/\"+tmp\n          console.log(tmp)\n          result1[i].fileHash=tmp\n        }\n       this.setState({avaibleDesign : result1})\n      } else {\n        console.log(error);\n      }\n    });\n  await this.setState({currentDesigns : true})\n  await this.setState({main : false})\n  Cookies.set('currentDesigns','true')\n  Cookies.remove('main')\n}\n//end main part\n\n\n\n\n//current Designs part\n\ntoMainC = async (event) => {\n  event.preventDefault()\n  console.log(\"to Main\")\n  Cookies.remove('currentDesigns')\n  await this.setState({currentDesigns : false})\n  await this.setState({main : true})\n  Cookies.set('main','true')\n}\n//end current designs part\n\n\n\n\n\n\n\n//announce part\nsetCommit = (event, maskedvalue, floatvalue) => {\n       this.setState({amount: floatvalue});\n       console.log(floatvalue)\n   }\n  formatSelect = async (event) => {\n    event.preventDefault()\n    console.log(\"format selected\")\n    const designFormat =  event.target.value\n    console.log(this.state.designFormat)\n    console.log(event.target.value)\n    await  this.setState({designFormat : designFormat })\n    console.log(this.state.designFormat)\n  }\n\n\n  captureFile = (event) => {\n    event.preventDefault()\n    const file = event.target.files[0]\n    //var stl = new NodeStl( file, {density: 1.04});\n  //  console.log(stl.volume);\n   const format = this.state.designFormat\n   if(format == \"stl\"){\n     this.setState({ stlFile: file })\n     this.setState({disableObj : false})\n     this.setState({disableStl : true})\n     console.log(this.state.stlFile)\n   }\n   else {\n     if(format == 'obj'){\n      this.setState({objFile : file})\n      this.setState({disableStl: false})\n      this.setState({disableObj : true})\n      console.log(this.state.objFile)\n     }\n     else {\n       console.log(\"format not selected\")\n     }\n   }\n    const reader = new window.FileReader()\n    reader.readAsArrayBuffer(file)\n    reader.onloadend = () => {\n      this.setState({ buffer: Buffer(reader.result) })\n      console.log('buffer', this.state.buffer)\n    }\n  }\n captureFile2 = async (event) => {\n event.preventDefault()\n console.log(\"charging designName\")\n const stri = event.target.value\n await this.setState({ designName: stri })\n console.log(this.state.designName)\n }\n captureFile5 = async (event) => {\n event.preventDefault()\n console.log(\"charging design description\")\n const stri = event.target.value\n await this.setState({ desc: stri})\n console.log(this.state.desc)\n }\n  onSubmit = async (event) => {\n    event.preventDefault()\n\n    await ipfs.add(this.state.buffer, async (error, result)  => {\n      console.log('Ipfs result', result)\n      if(error) {\n        console.error(error)\n        return\n      }\n      console.log(result)\n      this.setState({ designHash: result[0].hash })\n     console.log(\"Submitting data to ipfs\")\n      const designName = this.state.designName;\n      const desc = this.state.desc;\n      const makerName = this.state.name;\n      const makerSurname = this.state.surname;\n      const designHash = this.state.designHash;\n      if (designName == '' || makerName == '' || makerSurname == '' || desc == ''){\n        console.log(\"metadata not saved\")\n        this.setState({designName:'',makerName:'',makerSurname:'',desc:''})\n        return\n      }\n     else{\n       if(designHash == ''){\n         console.log(\"design not uploaded\")\n       }\n       else{\n           const toJSON = {\n               designName : designName,\n               makerName : makerName,\n               makerSurname : makerSurname,\n               desc : desc,\n               designHash : designHash\n               };\n       const myJson = JSON.stringify(toJSON) ;\n       console.log(toJSON)\n       console.log(myJson)\n       var buf = Buffer.from(myJson);\n       ipfs.add(buf, (error, result) => {\n         console.log('Ipfs result', result)\n         if(error) {\n           console.error(error)\n           return\n         }\n          console.log(result[0].hash)\n       })\n       this.setState({designName:'',makerName:'',makerSurname:'',desc:''})\n       }\n       }\n       this.state.contract.methods.getExpiry().call({from: this.state.account}).then((res) => {var hash = this.state.designHash\n       console.log(\"inizio conv\")\n    const fhash = this.getBytes32FromIpfsHash(hash)\n    const web3 = window.web3\n      console.log(\"solo fixedhash\",fhash)\n      console.log(this.state.contract)\n           console.log(res)\n    var currentTimeInSeconds=Math.floor(Date.now()/1000);\n           console.log(currentTimeInSeconds)\n     const amount1 = this.state.amount\n     console.log(amount1)\n     const amount = web3.utils.toWei(amount1.toString(), 'ether');\n          console.log(amount)\n     const manager = \"0xeFC24d39428360E526D467d219Ce85F0d9B71b8e\"\n    console.log('start smart contract call')\n    this.state.contract.methods.announce(fhash, currentTimeInSeconds, res, amount, manager).send({from : this.state.account, value : amount }).on('transactionHash', function(hash){ console.log(\"Hash: \" + hash);\n}).on('error', console.error).on('confirmation', function(confirmationNumber, receipt){\n    console.log(receipt)\n}).on('receipt', function(receipt){\n  console.log(\"provareceipt\")\n})})\n    })\n  }\n  toMainU = async (event) => {\n    event.preventDefault()\n    console.log(\"to Main\")\n    Cookies.remove('announce')\n    await this.setState({announce : false})\n    await this.setState({main : true})\n    Cookies.set('main','true')\n    console.log(this.state.announce)\n  }\n  // end announce part\n  render() {\n    return (\n      <div>\n        <nav className=\"navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow\">\n          <a\n            className=\"navbar-brand col-sm-3 col-md-2 mr-0\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            App di prova\n          </a>\n        </nav>\n        <div className=\"container-fluid mt-5\">\n          <div className=\"row\">\n            <main role=\"main\" className=\"col-lg-12 d-flex text-center\">\n              <div className=\"content mr-auto ml-auto\">\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                </a>\n\n                {/* loading part*/}\n                {(this.state.loading) && (<h1>Loading</h1>)}\n                {/*end loading part*/}\n\n                {/*login section*/}\n                <div >\n                {(!this.state.isLogged && !this.state.loading && !this.state.register) && (<h1 id=\"param1\">Login Page</h1>)}\n                {(!this.state.isLogged && !this.state.loading && this.state.register) && (<h1 id=\"param16\">Register Page</h1>)}\n                {/* user logged with metamask */}\n                <form>\n                {(this.state.ethBrowser && !this.state.isLogged && !this.state.loading) && (  <label id=\"param2\" >\n                username:\n                <input type=\"text\"  onChange={this.captureFileL} />\n                </label>)}\n                </form>\n                {(this.state.ethBrowser && !this.state.isLogged && !this.state.loading) && (<form>\n                 <label id=\"param3\">\n                password:\n                <input type=\"password\"  onChange={this.captureFileL1} />\n                </label>\n                </form>)}\n                {(this.state.ethBrowser && !this.state.isLogged && !this.state.loading && this.state.register) && (<form>\n                 <label id=\"param17\">\n                confirm password:\n                <input type=\"password\"  onChange={this.captureFileL5} />\n                </label>\n                </form>)}\n                {(this.state.invalidLogin && !this.state.isLogged && this.state.ethBrowser && !this.state.loading) && (<div id=\"param6\">invalid username/password</div>)\n                }\n                { (this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading) ?\n                <form>\n                <label id=\"param7\">\n                name:\n                <input type=\"text\"  onChange={this.captureFileL3} />\n                </label>\n                 </form>  : null\n                }\n                { (this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading) ?\n                <form>\n                <label id=\"param8\">\n                surname:\n                <input type=\"text\"  onChange={this.captureFileL4} />\n                </label>\n                </form>  : null\n                }\n                { (this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading) ?\n                <form>\n                <label id=\"param9\">\n                email:\n                <input type=\"text\"  onChange={this.captureFileL2} />\n                </label>\n                 </form>  : null\n                }\n                {(this.state.register && this.state.ethBrowser && this.state.invalidEmail && !this.state.isLogged && !this.state.loading) && (\n                 <div id=\"param10\">invalid email</div>)\n                 }\n\n                { (!this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading) && (\n                <button className=\"button\" id=\"param4\" onClick={this.startApi2}>Login</button>)\n                }\n\n                { (!this.state.register && this.state.ethBrowser  && !this.state.isLogged && !this.state.loading)  && (\n                  <button className=\"button\" id=\"param5\" onClick={this.setRegister}>Register</button>)\n                }\n\n                {(this.state.register && this.state.ethBrowser  && !this.state.isLogged && !this.state.loading) && (<form >\n                <label id=\"param14\">\n               Registration Type:\n               <select onChange = {this.registrationType}>\n               <option value=\"designer\">designer</option>\n               <option value=\"player\">player</option>\n               <option value=\"both\">both</option>\n              </select>\n              </label>\n              </form>)}\n              {(this.state.register && this.state.ethBrowser && this.state.invalidRegistration && !this.state.isLogged && !this.state.loading) && (\n               <div id=\"param15\">Username or wallet already registered</div>)\n               }\n               {(this.state.register && this.state.ethBrowser && this.state.invalidPassword && !this.state.isLogged && !this.state.loading) && (\n                <div id=\"param18\">Password and Confirm Password are different</div>)\n                }\n                { (this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading) && (\n                  <button className=\"button\" id=\"param11\" onClick={this.sendData}>SendData</button>)\n                }\n\n                { (this.state.register && this.state.ethBrowser && !this.state.isLogged && !this.state.loading) && (\n                  <button className=\"button\" id=\"param12\" onClick={this.Return}>Return</button>)\n                }\n\n                {/* end user logged with metamask*/}\n                {/*user without metamask*/}\n                {(!this.state.ethBrowser && !this.state.isLogged && !this.state.loading && !this.state.loading) && (<div id=\"param13\">Non-Ethereum browser detected, please install metamask.<br />\n                [.....metamask tutorial <a id=\"para\" href={'https://metamask.io/download.html'}>here</a>...]\n                </div>)}\n                {/*user without metamask*/}\n                </div>\n                {/*end login section*/}\n\n\n\n\n\n\n\n                {/*main section*/}\n                { (this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading) && (\n                <p>User data<br />name:{this.state.name}<br />surname:{this.state.surname}<br />email:{this.state.email}<br />wallet:{this.state.account}</p>)\n                }\n                { (this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading && this.state.designer) && (\n                <button className=\"button\"  onClick={this.toUpload}>Upload a design</button>)\n                }\n                { ( this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading) && (\n                  <button className=\"button\" onClick={this.logoutU}>Logout</button>)\n                }\n                { (this.state.ethBrowser && this.state.isLogged && this.state.main && !this.state.loading && this.state.player ) && (\n                <button className=\"button\" onClick={this.toCurrentDesigns} >List avaible design to vote</button>)\n                }\n                {/*end main section*/}\n\n\n\n\n                {/*see avaible design*/}\n                { (this.state.ethBrowser && this.state.isLogged && !this.state.loading && this.state.player && this.state.currentDesigns) &&\n                  (<ul>\n                    <table><tr><th>designNo</th><th>creatorAddress</th><th>design</th></tr>{this.state.avaibleDesign.map((item)=><tr><td>{item.designNo.toString()}</td><td>{item.creator.toString()}</td><td>{item.fileHash.toString()}</td></tr>)}</table>\n                </ul>)}\n                { (this.state.ethBrowser && this.state.isLogged && !this.state.loading && this.state.player && this.state.currentDesigns) && (\n                  <button  className=\"button\" onClick={this.toMainC}>Return</button>)\n                }\n                {/*see avaible design*/}\n\n\n\n\n                {/*announce section*/}\n                {(this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (<div>Design caricato:</div>)}\n                {(this.state.ethBrowser && this.state.isLogged && this.state.disableStl && this.state.announce && !this.state.loading && this.state.stlFile && this.state.designer) ?\n                       <STLViewer\n                           onSceneRendered={(element) => {\n                               console.log(element)\n                           }}\n                           sceneClassName=\"test-scene\"\n                           file={this.state.stlFile}\n                           className=\"obj\"\n                           modelColor=\"#FF0000\"/> : null\n\n                   }\n               {(this.state.ethBrowser && this.state.isLogged && this.state.disableObj && this.state.announce && !this.state.loading && this.state.objFile && this.state.designer) ?\n                        <OBJViewer\n                            onSceneRendered={(element) => {\n                                console.log(element)\n                            }}\n                            sceneClassName=\"test-scene\"\n                            file={this.state.objFile}\n                            className=\"obj\"\n                            modelColor=\"#FF0000\"/> : null\n                    }\n\n                <p>&nbsp;</p>\n                {(this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (<h2>Change design</h2>)}\n                {(this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (<form>\n                  <input type='file'  onChange={this.captureFile} />\n                <p>&nbsp;</p>\n                </form>)}\n                {(this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (<form >\n                <p>&nbsp;</p>\n                <label>\n                Design title:\n                <input type=\"text\" onChange={this.captureFile2} />\n                </label>\n                </form>)}\n                {(this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (<form onSubmit={this.captureFile2}>\n               <label>\n                Design description:\n                <textarea onChange={this.captureFile5} />\n               </label>\n               </form>)}\n               { (this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) &&(<form>\n                             amount:\n                               <CurrencyInput value={this.state.amount} onChangeEvent={this.setCommit}\n                               CurrencyInput suffix=\" ETH\" />\n                          </form>) }\n              {(this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (<button class=\"button\" onClick={this.onSubmit}>Submit</button>)}\n              {(this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (<form >\n              <label>\n             Select design format:\n             <select onChange = {this.formatSelect}>\n             <option value=\"stl\">.stl</option>\n             <option value=\"obj\">.obj</option>\n          </select>\n        </label>\n      </form>)}\n      { (this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (\n        <button className=\"button\" onClick={this.logoutU}>Logout</button>)\n      }\n      { (this.state.ethBrowser && this.state.isLogged && this.state.announce && !this.state.loading && this.state.designer) && (\n        <button className=\"button\" onClick={this.toMainU}>Return</button>)\n      }\n      {/*end announce section*/}\n              </div>\n            </main>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}